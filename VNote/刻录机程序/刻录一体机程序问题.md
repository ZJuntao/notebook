# sbp1000程序相关问题
1. c程序在中标麒麟下编译，链接libusb库：-lusb-1.0
2. 命令行启动需加sudo
3. GetDiskState（）检查光驱是否有盘，如有拿出放入成品仓函数，无盘会出错，光驱不收回，问题点：
    > * TYPE_NO_DISK赋值（自定义为24）;
    > * 无盘时type为0，没有赋值（已修改，将 **get_disk_type()** 中的type_cd = "CD-ROM"）;
    > * 程序结束前添加收回光驱函数（已修改）;
    > *注意：在已经声明接口后，不能在内部调用函数内还需声明接口的函数*;
4. 成品仓收回后不会关闭仓门（已修改）
5. 光驱仓放盘问题：（暂定）
    >* 需要在什么时候判断盘内是否有盘；
    >* 目前冲突是：光驱仓放盘时会判断光驱仓是否有盘，但会重新收回光驱，没有弹出指令，多了一个步骤，是否有必要？（暂时修改为去掉判断）
6. 编译错误 copCDPrint.c ln 823,6104，  myudp.h ln20 NULL（已修改）
7. 清理无用的代码
8. 命名：sbpsvr,sbpdiag 编译命令写到文件前（已修改）
9. 注释 /\**/ => //已修改）
10. sbpsvr是否在运行 netstat -anp|grep 17008
11. 获取版本、序列号(已添加开启ui程序就获取版本、序列号，但如果服务端没有开启不会有反应，需改进）
12. 设备是否连接成功，按钮功能分组，按钮的enable/disable
13. 错误信息分类处理
14. sbpsvr 设备连接与重连
15. 打开ui检查服务是否在运行，同10，11
16. Qt中的group分组，没有连接时无法点击
17. 查看成品仓和空白仓光盘数量会少一张
18. 信号机制：（已添加）
    > 信号机制作用：在程序被杀死的同时做程序正常退出的动作，如关掉文件描述符fd。
19. 光驱操作代码：cdr.py
20. 发送给ui的消息有长后缀（已修改：发送数据大小用strlen）
21. qt4编译后ui收不到服务端发来的消息
22. ./cdrskin --devices查看光驱型号，可以此寻找并控制光驱
23. 烘干时间？
24. 获取版本号和序列号源码，如何解析，为何为0？（读取文档信息判断）
25. 打印盘面大小：2833\*2833，按行发送，不创建prt文件，实际文件大小：2838\*2838
26. 墨盒文件不创建
27. 新增动作，已初步完成接口和通讯
28. 各个动作需用时间：
    |    动作   |  需要用时   |        
    | -------- | ------------ |
    |     |     |
    |     |     |
    |     |     |
    |     |     |
    |     |     |
    |     |     |
    |     |     |
## 20201203新增问题
29. spb1000.txt文件中需要修改的地方（已修改）
30. 打印盘面时，指定文件不存在后会死机 **（重要）**（新增返回错误值，待验证）
31. 初始化中断，会使FN功能键不能用（如提供的初始化接口会判断成品仓和空白仓数量，若不符合会出错）（已修改，出错后开启FN功能键）
32. 修改多余的光驱操作，目前只判断光驱中是否有盘（已修改）
33. 命令协议整理：将多余重复性操作改为函数
34. PrepareMedia(0)动作时，增加检测光驱内是否有盘，有盘则放入成品仓（*已修改*）
## 20201204新增问题
35. 收回光盘会有判断光盘类型的操作，去掉判断（一般为放盘时）
36. PrintDisk(char *bmpPath)函数，若光驱无盘时错误处理
37. 打印盘面黑白颜色转换问题（已解决）
38. 删除多余的打印内容（光驱方面的操作）（已修改）
39. 盘面打印会出现错位，8bit高低位反了
40. InitDevice时：（已修改）
    >* 空白仓未归位时应报错
    >* 成品仓有盘时应报错